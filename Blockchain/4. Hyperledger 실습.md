# Hyperledger



###### ì‹¤ìŠµí•´ë´…ì‹œë‹¤

1. node -vë¡œ ë²„ì „ í™•ì¸

   **nodeëŠ” 8.xë²ˆëŒ€ë¡œ ìœ ì§€ë˜ì–´ì•¼ í•¨**  <- **ì´ê±° ë§¤ìš° ì¤‘ìš”**

   HLF SDKì™€ ë²„ì „ì´ ë§ì•„ì•¼ í•¨

   

   ë²„ì „ì´ ë‹¤ë¥´ë©´ nì„ ê¹”ì•„ì•¼ í•¨

   1.  `curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | sudo bash`

   2. `source .bashrc`

   3. `chmod 777 .nvm` (í˜¹ì‹œ ì¼ë°˜ ê³„ì •ìœ¼ë¡œ ì‘ì—…í•˜ë‹¤ ê¶Œí•œ ì˜¤ë¥˜ë‚˜ë©´)

   4. `nvm install 8.9.0`
      ë§Œì•½ nvmì´ ì„¤ì¹˜ê°€ ì•ˆë˜ë©´

      `apt install npm` 

      `npm install n -g`

      `n 8.9.0`

   

2. `mkdir 1jes` -> `cd 1jes`



3. `mkdir myweb` -> `cd myweb` -> `mpn init`



4. `npm i express` -> ``npm i -g nodemon`



5. `mkdir public` -> `gedit public/index/html`í›„ ë‹¤ìŒì„ ì‘ì„±

   ```html
   
   <!DOCTYPE html>
   <html lang="en">
     <head>
       <meta charset="utf-8" />
       <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" >
       <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.3/react.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.3/react-dom.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/react-router/1.0.2/ReactRouter.js"></script>
       <script src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script>
       <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
       <link rel="stylesheet" type="text/css" href="index.css">
       <title>React App</title>
     </head>
     <body>
      <div id="root" ></div>
      <script type="text/babel" src="index.jsx" />
     </body>
   </html>
   ```

   

6. `gedit public/index.jsx`

   ```react
   
   var {Component} = React;
   var {Router, Route, IndexRoute, Link} = ReactRouter;
    
   class Main extends Component{
       render(){
           return(            
               <div>
                   <h1>Hyperledger Fabric Study</h1>
                   <ul className="header" >
                       <li><Link exact to="/">Home</Link></li>
                       <li><Link to="/basic">BasicNetwork</Link></li>
                       <li><Link to="/first">FirstNetwork</Link></li>
                   </ul>
                   <div className="content">
                   {this.props.children}
                   </div>
               </div>            
           );
       }
   }
    
   class Home extends Component{
       render(){
           return(
               <div>
                   <h2>HELLO</h2>
                   <p>ì•ˆë…•í•˜ì„¸ìš”? í•˜ì´í¼ë ˆì €ì— ì ‘ì†í•˜ëŠ” ë…¸ë“œ ì›¹ ì˜ˆì œì…ë‹ˆë‹¤. ì˜í•´ë³´ì£ ~!!!</p>
               </div>
           );
       }
   }
   class BasicNetwork extends Component{
       basic_network=()=>{
           axios.get('/basic_network')
           .then((response)=>{
               console.log(response);
               
           })
           .catch((error)=>{
               console.log(error);
           });
       }
       send=()=>{
           alert(this.amount.value);
           axios.post('/basic_network',{"amount":this.amount.value})
           .then((response)=>{
               console.log(response);
               
           })
           .catch((error)=>{
               console.log(error);
           });
       }
    
       render(){
           return(
               <div>
                   <h2>BasicNetwork</h2>
                   <p><button onClick={this.basic_network}>ì—°ê²°</button></p>
                   <br/>
                   <div>aê°€ bì—ê²Œ {' '}
                   <input placeholder='ì†¡ê¸ˆëŸ‰' ref={ref=>this.amount=ref} />ì›ì„ {' '} 
                   <button onClick={this.send}  > ë³´ë‚´ê¸°</button><br/>               
                   </div>
               </div>
           );
       }
   }
   class FirstNetwork extends Component{  
    
       render(){
           return(
               <div>
                   <h2>FirstNetworkì— ì—°ê²° í•´ë³´ì„¸ìš”</h2>                
               </div>
           );
       }
   }
    
   ReactDOM.render(
       (<Router>
           <Route path="/" component={Main} >   
               <Route path="basic" component={BasicNetwork}/>
               <Route path="first" component={FirstNetwork} />
               <IndexRoute component={Home} />
           </Route>
       </Router>)
       ,document.getElementById("root")
   );
   ```



7. `gedit public/index.css`

   ```css
   body{
       background-color: #FFCC00;
       padding:20px;
       margin:0;
   }
   h1,h2,p,ul,li{
       font-family:sans-serif;
   }
   ul.header li{
       display: inline;
       list-style-type:none;
       margin:0;
   }
   ul.header{
       background-color: #111;
       padding: 0;
   }
   ul.header li a{
       color:#FFF;
       font-weight: bold;
       text-decoration: none;
       padding: 20px;
       display: inline-block;
   }
   .content{
       background-color: #FFF;
       padding: 20px;
   }
   .content h2{
       padding: 0;margin:0;
   }
   .content li{
       margin-bottom: 10px;
   }
   a:hover{
       background-color: #0099ff;
   }
   
   ```



8. mywebì— server.js íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±

   ```javascript
   const express=require("express");
   const path=require("path");
   const app=express(); 
    
   app.use(express.static(path.join(__dirname,"/public")));
    
   app.use(express.json());
    
   app.use('/basic_network', require('./routes/basic_network_router'));
    
   app.listen(3000,function(){
       console.log("3000 server ready...");
   });
   ```



9. myweb/routes/basic_network_router.jsë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±

   ```javascript
   const express = require('express');
   const router = express.Router();
   
   /* GET */
   router.get('/', function(req, res, next) {
       res.json({"msg":"ok"});
     });
     
   module.exports = router;
   ```



10. package.jsonì— ë‹¤ìŒì„ ì¶”ê°€

    ```json
    //script ë¶€ë¶„ì—
    "start": "nodemon server.js",
    
    ```



11. ifconfigë¡œ IPë¥¼ í™•ì¸í•´ì„œ ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•´ë³´ê¸°

    ~~ì•ˆë˜ë©´ `apt install net-tools`~~

    ![11](https://user-images.githubusercontent.com/20276476/79812274-68de3880-83b3-11ea-910d-5b8c2465543b.png)

    ì˜ ëœ¬ë‹¤



12. í™”ë©´ì— BasicNetworkìœ¼ë¡œ ê°€ì„œ ì—°ê²° ë²„íŠ¼ì„ ëˆ„ë¥´ê³  F12í‚¤ë¡œ ë©”ì‹œì§€ê°€ ì˜ ì˜¤ëŠ”ì§€ í™•ì¸



*****



###### í•˜ì´í¼ë ˆì € ë“¤ì–´ê°‘ë‹ˆë‹¤

1. package.jsonì˜ dependenciesì— ë‹¤ìŒì„ ì¶”ê°€

       "fabric-ca-client": "~1.4.0",
       "fabric-client": "~1.4.0",
       "fabric-network": "^1.4.4",
   dependenciesê°€ ì—†ìœ¼ë©´ ëª…ë ¹ì°½ì— ì§ì ‘ ì„¤ì¹˜

   `npm i fabric-ca-client@1.4.0`

   `npm i fabric-client@1.4.0`

   `npm i fabric-network@1.4.0`

   

2. docker ë²„ì „ í™•ì¸

   `docker -v`



3. docker-compose ë²„ì „í™•ì¸

   `docker-compose -v`

   ì—†ìœ¼ë©´ ì„¤ì¹˜

   `apt -y install docker-compose`

   > docker-composeëŠ” containerë“¤ì„ ì—°ê³„í•´ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤

   

4. go ë²„ì „ í™•ì¸

   `go version`

   ì—†ìœ¼ë©´ ì„¤ì¹˜

   `apt -y install golang-go`



5. go ìœ„ì¹˜ í™•ì¸

   `go env`

   ```text
   GOPATH="/root/go"
   
   GOROOT="/usr/lib/go-1.10"
   ```

   ê°€ ë§ëŠ”ì§€ í™•ì¸

   

6. `sudo apt install -y vim`(ë°°í¬ë°›ì€ ìš°ë¶„íˆ¬ ë²„ì „ì—ëŠ” ìˆìœ¼ë‹ˆ í•  í•„ìš” ì—†ìŒ)

   

7. `vi .bashrc` -> 

   ```text
   export GOPATH="/root/go"
   export GOROOT="/usr/lib/go-1.10"
   ```

   ë¶™ì—¬ë†“ê³ 

   `source .bashrc` -> í™˜ê²½ ë³€ìˆ˜ ë“±ë¡

   ì ìš© í™•ì¸

   `echo $GOROOT && echo $GOPATH`

   

8. `mkdir HLF` -> `cd HLF`í›„

   `curl -sSL http://bit.ly/2ysbOFE | bash -s 1.4.3`

   **í•˜ì´í¼ë ˆì € íŒ¨ë¸Œë¦­ì„ ì„¤ì¹˜, 2019/8/21 1.4.2 ë²„ì „ ì„¤ì¹˜ë¨,**ğŸ¡º**2019/8/31ì— 1.4.3ë²„ì „ ì„¤ì¹˜ë¨**

   >dockerê°€ root ê³„ì •ìœ¼ë¡œ ì´ë¯¸ ì„¤ì¹˜ ë˜ì—ˆì„ë•Œ root ê³„ì •ì´ ì•„ë‹Œ ê³„ì •ìœ¼ë¡œ dockerë¥¼ ì‹¤í–‰í•˜ê³ ì í•˜ë©´ [Solving Docker permission denied while trying to connect to the Docker daemon socket]ê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•  ë•Œê°€ ìˆë‹¤. ì´ë•ŒëŠ”$ sudo usermod -a -G docker $USER $ sudo service docker restart í•˜ë©´ ë¨



	> ë°°í¬íŒŒì¼ ì¤‘ 3ë²ˆì€ ìœ„ì˜ í™˜ê²½ ì„¤ì¹˜ë¥¼ í•´ì¤˜ì•¼ í•œë‹¤
	>
	> ë°°í¬íŒŒì¼ ì¤‘ 4ë²ˆì€  ë‹¤ìŒë¶€í„° ì‹œì‘í•˜ë©´ ëœë‹¤(í™˜ê²½ ì…‹íŒ…ì´ ì™„ë£Œë¨)



9. `docker images`ë¡œ ë°›ì•„ì§„ ì´ë¯¸ì§€ë“¤ í™•ì¸

   fabric-ca, fabric-zookeeper, fabric-kafka, fabric-couchdb, fabric-tools(cli), fabric-ccenv, fabric-orderer, fabric-peer, fabric-javaenvê°€ ìˆë‹¤



10. `docker ps`ë¡œ ëŒê³ ì‡ë‚˜ í™•ì¸ -> ì•„ë¬´ê²ƒë„ ì—†ì–´ì•¼ ë¨



> Hyperledger fabricì´ë¯¸ì§€ì™€ ìƒ˜í”Œì„ ë™ì‹œì— ë°›ì€ ê²ƒ

**ìƒ˜í”Œì´ fabricì´ ì•„ë‹ˆë‹¤**



11. `ls`ëª…ë ¹ì–´ë¡œ fabric-samplesí´ë”ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤

![12](https://user-images.githubusercontent.com/20276476/79815761-6df3b580-83bc-11ea-9ce5-704e2757fde0.png)

**ê°ê° í´ë”ê°€ ë­˜ í•˜ëŠ”ê±´ì§€ ì˜ ì•Œì•„ì•¼ í•¨**

* basic-network, first-network : ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì— ëŒ€í•´ ë‹´ê²¨ìˆìŒ
* balance-transfer : ë˜ í•˜ë‚˜ì˜ ì˜ˆì œ(ì”ì•¡ ì†¡ê¸ˆ) -> ë„¤íŠ¸ì›¤ ì•ˆì— ì²´ì¸ì½”ë“œê¹Œì§€ ë‹¤ ë“¤ì–´ìˆìŒ
* fabcar : ì±…ì— ë‚˜ì™€ìˆëŠ” car ì˜ˆì œ
* commercial-paper : ì¢…ì´ ë¬´ì—­ ì˜ˆì œ



*****

###### ìì„¸íˆ ë´…ì‹œë‹¤



1. `cd basic-network` -> `ls`

   yaml, yml -> êµ¬ì„±íŒŒì¼ / sh -> ì‹¤í–‰íŒŒì¼



2. `apt install -y tree`



3. `cd ..`í›„ `tree basic-network`ë¥¼ ì¹˜ë©´ í´ë” êµ¬ì¡°ë¥¼ ê·¸ë¦¼ê³¼ ê°™ì´ ì˜ ë³´ì—¬ì¤€ë‹¤

   ![13](https://user-images.githubusercontent.com/20276476/79816197-9af49800-83bd-11ea-9687-2e4974314ee1.png)



4. start shellì„ ê°€ë™

   `cd basic-network` -> `ls`ë¡œ start.shì´ ìˆëŠ”ì§€ í™•ì¸

   `./start.sh`



5. `docker ps`ë¡œ ìœ„ì™€ ê°™ì´ ê°€ë™ì¤‘ì¸ ì»¨í…Œì´ë„ˆë“¤ í™•ì¸

   ![13](https://user-images.githubusercontent.com/20276476/79816308-ec048c00-83bd-11ea-9138-9f3cb91cfcb7.png)



6. `gedit docker-compose.yml`ì„ ì…ë ¥í•˜ì—¬ ë³´ê¸°

   ```yaml
   #
   # Copyright IBM Corp All Rights Reserved
   #
   # SPDX-License-Identifier: Apache-2.0
   #
   version: '2'
   
   networks:
     basic:
   
   ######################################################################
   # fabric-ca
   ######################################################################
   services:
     ca.example.com:
       image: hyperledger/fabric-ca
       environment:
         - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
         - FABRIC_CA_SERVER_CA_NAME=ca.example.com
         - FABRIC_CA_SERVER_CA_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.example.com-cert.pem
         - FABRIC_CA_SERVER_CA_KEYFILE=/etc/hyperledger/fabric-ca-server-config/4239aa0dcd76daeeb8ba0cda701851d14504d31aad1b2ddddbac6a57365e497c_sk
       ports:
         - "7054:7054"
       command: sh -c 'fabric-ca-server start -b admin:adminpw'
       volumes:
         - ./crypto-config/peerOrganizations/org1.example.com/ca/:/etc/hyperledger/fabric-ca-server-config
       container_name: ca.example.com
       networks:
         - basic
   
   ######################################################################
   # fabric-orderer
   ######################################################################
     orderer.example.com:
       container_name: orderer.example.com
       image: hyperledger/fabric-orderer
       environment:
         - FABRIC_LOGGING_SPEC=info
         - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
         - ORDERER_GENERAL_GENESISMETHOD=file
         - ORDERER_GENERAL_GENESISFILE=/etc/hyperledger/configtx/genesis.block
         - ORDERER_GENERAL_LOCALMSPID=OrdererMSP
         - ORDERER_GENERAL_LOCALMSPDIR=/etc/hyperledger/msp/orderer/msp
       working_dir: /opt/gopath/src/github.com/hyperledger/fabric/orderer
       command: orderer
       ports:
         - 7050:7050
       volumes:
           - ./config/:/etc/hyperledger/configtx
           - ./crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/:/etc/hyperledger/msp/orderer
           - ./crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/:/etc/hyperledger/msp/peerOrg1
       networks:
         - basic
   
   ######################################################################
   # fabric-peer
   ######################################################################
     peer0.org1.example.com:
       container_name: peer0.org1.example.com
       image: hyperledger/fabric-peer
       environment:
         - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
         - CORE_PEER_ID=peer0.org1.example.com
         - FABRIC_LOGGING_SPEC=info
         - CORE_CHAINCODE_LOGGING_LEVEL=info
         - CORE_PEER_LOCALMSPID=Org1MSP
         - CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/peer/
         - CORE_PEER_ADDRESS=peer0.org1.example.com:7051
         # # the following setting starts chaincode containers on the same
         # # bridge network as the peers
         # # https://docs.docker.com/compose/networking/
         - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${COMPOSE_PROJECT_NAME}_basic
         - CORE_LEDGER_STATE_STATEDATABASE=CouchDB
         - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb:5984
         # The CORE_LEDGER_STATE_COUCHDBCONFIG_USERNAME and CORE_LEDGER_STATE_COUCHDBCONFIG_PASSWORD
         # provide the credentials for ledger to connect to CouchDB.  The username and password must
         # match the username and password set for the associated CouchDB.
         - CORE_LEDGER_STATE_COUCHDBCONFIG_USERNAME=
         - CORE_LEDGER_STATE_COUCHDBCONFIG_PASSWORD=
       working_dir: /opt/gopath/src/github.com/hyperledger/fabric
       command: peer node start
       # command: peer node start --peer-chaincodedev=true
       ports:
         - 7051:7051
         - 7053:7053
       volumes:
           - /var/run/:/host/var/run/
           - ./crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp:/etc/hyperledger/msp/peer
           - ./crypto-config/peerOrganizations/org1.example.com/users:/etc/hyperledger/msp/users
           - ./config:/etc/hyperledger/configtx
       depends_on:
         - orderer.example.com
         - couchdb
       networks:
         - basic
   
   ######################################################################
   # couchdb
   ######################################################################
     couchdb:
       container_name: couchdb
       image: hyperledger/fabric-couchdb
       # Populate the COUCHDB_USER and COUCHDB_PASSWORD to set an admin user and password
       # for CouchDB.  This will prevent CouchDB from operating in an "Admin Party" mode.
       environment:
         - COUCHDB_USER=
         - COUCHDB_PASSWORD=
       ports:
         - 5984:5984
       networks:
         - basic
   
   ######################################################################
   # cli(tools)
   ######################################################################
     cli:
       container_name: cli
       image: hyperledger/fabric-tools
       tty: true
       environment:
         - GOPATH=/opt/gopath
         - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
         - FABRIC_LOGGING_SPEC=info
         - CORE_PEER_ID=cli
         - CORE_PEER_ADDRESS=peer0.org1.example.com:7051
         - CORE_PEER_LOCALMSPID=Org1MSP
         - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
         - CORE_CHAINCODE_KEEPALIVE=10
       working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
       command: /bin/bash
       volumes:
       	# ìš°ë¶„íˆ¬ ê²½ë¡œ:ì»¨í…Œì´ë„ˆ ì•ˆì˜ ê²½ë¡œ
           - /var/run/:/host/var/run/
           - ./../chaincode/:/opt/gopath/src/github.com/ (!!! ì£¼ëª©)
           - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/
       networks:
           - basic
       #depends_on:
       #  - orderer.example.com
       #  - peer0.org1.example.com
       #  - couchdb
   ```

   

7. `gedit start.sh`ë¡œ ë³´ì

   ```bash
   #!/bin/bash
   #
   # Copyright IBM Corp All Rights Reserved
   #
   # SPDX-License-Identifier: Apache-2.0
   #
   # Exit on first error, print all commands.
   set -ev
   
   # don't rewrite paths for Windows Git Bash users
   export MSYS_NO_PATHCONV=1
   
   docker-compose -f docker-compose.yml down
   
   ######################################################################
   # ì—¬ê¸°ê°€ ì™„ì „ í•µì‹¬
   # ì—¬ê¸°ì„œ composeë¡œ ë‹¤ ëŒë¦¼
   docker-compose -f docker-compose.yml up -d ca.example.com orderer.example.com peer0.org1.example.com couchdb
   docker ps -a
   ######################################################################
   # ì´ë ‡ê²Œ ë°”ê¿”ì£¼ì…ˆ
   docker-compose -f docker-compose.yml up -d ca.example.com orderer.example.com peer0.org1.example.com couchdb
   docker ps -a cli
   # cli ì¶”ê°€
   ######################################################################
   
   # wait for Hyperledger Fabric to start
   # incase of errors when running later commands, issue export FABRIC_START_TIMEOUT=<larger number>
   export FABRIC_START_TIMEOUT=10
   #echo ${FABRIC_START_TIMEOUT}
   sleep ${FABRIC_START_TIMEOUT}
   
   # Create the channel
   docker exec -e "CORE_PEER_LOCALMSPID=Org1MSP" -e "CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp" peer0.org1.example.com peer channel create -o orderer.example.com:7050 -c mychannel -f /etc/hyperledger/configtx/channel.tx
   # Join peer0.org1.example.com to the channel.
   docker exec -e "CORE_PEER_LOCALMSPID=Org1MSP" -e "CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp" peer0.org1.example.com peer channel join -b mychannel.block
   ```

   

8. `./stop.sh`ë¡œ ê°€ë™ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ì¤‘ì§€ í›„ ë‹¤ì‹œ `./start.sh`ë¡œ ê°€ë™



9. `docker ps`ë¡œ ë‹¤ì„¯ê°œê°€ ê°€ ë– ìˆëŠ”ì§€ í™•ì¸

   ![14](https://user-images.githubusercontent.com/20276476/79817392-5ae2e480-83c0-11ea-985a-2e2864579b55.png)



10. `docker exec -it cli bash`ì…ë ¥í•˜ì—¬ cli containerë¡œ ë“¤ì–´ê°



11. github.com ê²½ë¡œê¹Œì§€ ì˜¬ë¼ê°€ì•¼ë¨ -> `cd ../../..`

    chaincodeê²½ë¡œì™€ ê°™ì€ì§€ í™•ì¸(ë³¼ë¥¨ì´ ì˜ ì¡í˜”ë‚˜)



12. `cd sacc` -> `cat sacc.go`í•˜ë©´ ëŒ€ëµì ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ



13. github.comê²½ë¡œë¡œ ê°€ì„œ `peer chaincode install -n jes -v 1.0 -p github.com/sacc`

    -n : ì´ë¦„

    -v : ë²„ì „

    -p : ê²½ë¡œ



14. ìƒˆ cmdë¥¼ ì—´ì–´ì„œ `docker exec -it peer0.org1.example.com bash`



15. `cd /var/hyperledger/production/chaincodes/`ë¡œ ê²½ë¡œ ì´ë™

    jes1.0ì´ ë³´ì„ -> ì²´ì¸ì½”ë“œì„



16. `cd /var/hyperledger/production/ledgersData/chains/chains/mychanne
    l`ë¡œ ì´ë™ -> ë¸”ëŸ­ íŒŒì¼ì„ ë³¼ ìˆ˜ ìˆìŒ



17. ì²´ì¸ì½”ë“œ ê°ì²´í™”

    `peer chaincode instantiate -n jes -v 1.0 -c '{"Args":["a", "10"]}' -C mychannel`

    > aë¼ëŠ” keyì— 10ì´ë¼ëŠ” valueê°€ ë“¤ì–´ê°€ìˆìŒ



18. ì•„ê¹Œ ë´¤ë˜ ë¸”ëŸ­íŒŒì¼ì˜ í¬ê¸°ë¥¼ ë³´ë©´ ìš©ëŸ‰ì´ ëŠ˜ì–´ë‚œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤ -> ë¸”ëŸ­ì´ ìƒê¸´ê±°

    

19. ë¸Œë¼ìš°ì €ì—ì„œ http://localhost/_utils ë¥¼ ì¹˜ë©´ couchdbì— ì ‘ì†í•  ìˆ˜ ìˆë‹¤(worldstate)

    mychannel_jesì— ë“¤ì–´ê°€ë©´ ì•„ê¹Œ ë„£ì—ˆë˜ a ê°’ì„ ë³¼ ìˆ˜ ìˆë‹¤

    ```text
    {
      "_id": "a",
      "_rev": "1-50b7693de6385699fdaa68e9e4edd08e",
      "~version": "\u0000CgMBAQA=",
      "_attachments": {
        "valueBytes": {
          "content_type": "application/octet-stream",
          "revpos": 1,
          "digest": "md5-1e0SNhwP1uxSYtoOGL2Uow==",
          "length": 2,
          "stub": true
        }
      }
    }
    ```



ì°¸ê³ . peer ê´€ë ¨ ëª…ë ¹

```text
peer chaincode ëª…ë ¹ ì˜µì…˜ ( ì°¸ì¡° : https://hihellloitland.tistory.com/48?category=766221 )

peer chaincode install      [flags]
peer chaincode instantiate  [flags]
peer chaincode invoke       [flags]
peer chaincode list         [flags]
peer chaincode package      [flags]
peer chaincode query        [flags]
peer chaincode signpackage  [flags]
peer chaincode upgrade      [flags]

peer chaincode install ëª…ë ¹ì€ ë‹¤ìŒ ëª…ë ¹ íŠ¹ì • í”Œë˜ê·¸ê°€ ìˆìŠµë‹ˆë‹¤ :
-c, --ctor <string> JSON í˜•ì‹ì˜ ì²´ì¸ ì½”ë“œ ìƒì„±ì ë©”ì‹œì§€ (ê¸°ë³¸ê°’ "{}")
-l, --lang <string> ì²´ì¸ ì½”ë“œê°€ ì“°ì—¬ì§„ ì–¸ì–´ (ê¸°ë³¸ "golang")
-n, --name <string> ì¸ìŠ¤í†¨ë˜ê³ ìˆëŠ” ì²´ì¸ ì½”ë“œì˜ ì´ë¦„. ì˜ìˆ«ì, ëŒ€ì‹œ ë° ë°‘ì¤„ë¡œ êµ¬ì„± ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
-p, --path <string> ì¸ìŠ¤í†¨ë˜ê³ ìˆëŠ” ì²´ì¸ ì½”ë“œì˜ ê²½ë¡œ. Golang (-l golang) ì²´ì¸ ì½”ë“œì˜ ê²½ìš° GOPATHì— ìƒëŒ€ì ì¸ ê²½ë¡œì…ë‹ˆë‹¤. Node.js (-l ë…¸ë“œ) ì²´ì¸ ì½”ë“œì˜ ê²½ìš° ì´ê²ƒì€ ì„¤ì¹˜ ëª…ë ¹ì´ ìˆ˜í–‰ë˜ëŠ” ì ˆëŒ€ ê²½ë¡œ ë˜ëŠ” ìƒëŒ€ ê²½ë¡œì…ë‹ˆë‹¤
-v, --version <string> ì„¤ì¹˜ì¤‘ì¸ ì²´ì¸ ì½”ë“œì˜ ë²„ì „. ì˜ìˆ«ì, ëŒ€ì‹œ, ë°‘ì¤„, ë§ˆì¹¨í‘œ ë° ë”í•˜ê¸° ê¸°í˜¸ë¡œ êµ¬ì„± ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
 
peer chaincode instantiate ëª…ë ¹ì€ ë‹¤ìŒ ëª…ë ¹ íŠ¹ì • í”Œë˜ê·¸ê°€ ìˆìŠµë‹ˆë‹¤ :
-C, --channelID <string> ì²´ì¸ ì½”ë“œë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•´ì•¼í•˜ëŠ” ì±„ë„ì˜ ì´ë¦„ì…ë‹ˆë‹¤.
-c, --ctor <string> JSON í˜•ì‹ì˜ ì²´ì¸ ì½”ë“œ ìƒì„±ì ë©”ì‹œì§€ (ê¸°ë³¸ê°’ "{}")
-E, --escc <string> ì´ ì²´ì¸ ì½”ë“œì— ì‚¬ìš©í•  ë³´ì¦ ì‹œìŠ¤í…œ ì²´ì¸ ì½”ë“œì˜ ì´ë¦„ (ê¸°ë³¸ê°’ "escc")
-n, --name <string> ì¸ìŠ¤í„´ìŠ¤í™”ë˜ëŠ” ì²´ì¸ ì½”ë“œì˜ ì´ë¦„ì…ë‹ˆë‹¤.
-P, --policy <string> ì´ ì²´ì¸ ì½”ë“œì™€ ê´€ë ¨ëœ ë³´ì¦ ì •ì±…. ê¸°ë³¸ì ìœ¼ë¡œ íŒ¨ë¸Œë¦­ì€ "í˜„ì¬ ì±„ë„ì— ìˆëŠ” ì¡°ì§ì˜ ëª¨ë“  êµ¬ì„±ì›"ê³¼ ë™ì¼í•œ ë³´ì¦ ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤.
-v, --version <string> ì¸ìŠ¤í„´ìŠ¤í™”ë˜ëŠ” ì²´ì¸ ì½”ë“œì˜ ë²„ì „
-V, --vscc <string> ì´ ì²´ì¸ ì½”ë“œì— ì‚¬ìš©í•  í™•ì¸ ì‹œìŠ¤í…œ ì²´ì¸ ì½”ë“œ ì´ë¦„ (ê¸°ë³¸ê°’ : "vscc")
 
peer chaincode query ëª…ë ¹ì€ ë‹¤ìŒ ëª…ë ¹ íŠ¹ì • í”Œë˜ê·¸ê°€ ìˆìŠµë‹ˆë‹¤ :
-C, --channelID <string> ì²´ì¸ ì½”ë“œë¥¼ ì¿¼ë¦¬í•´ì•¼í•˜ëŠ” ì±„ë„ì˜ ì´ë¦„ì…ë‹ˆë‹¤.
-c, --ctor <string> JSON í˜•ì‹ì˜ ì²´ì¸ ì½”ë“œ ìƒì„±ì ë©”ì‹œì§€ (ê¸°ë³¸ê°’ "{}")
-n, --name <string> ì¿¼ë¦¬ë˜ëŠ” ì²´ì¸ ì½”ë“œì˜ ì´ë¦„ì…ë‹ˆë‹¤.
-r --raw ì¿¼ë¦¬ ê°’ì„ ì›ì‹œ ë°”ì´íŠ¸ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤ (ê¸°ë³¸ê°’).
-x --hex ì¿¼ë¦¬ ê°’ ë°”ì´íŠ¸ ë°°ì—´ì„ 16 ì§„ìˆ˜ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤. í˜¸í™˜ë˜ì§€ ì•ŠëŠ” with -raw
 
peer chaincode upgrade ëª…ë ¹ì€ ë‹¤ìŒ ëª…ë ¹ íŠ¹ì • í”Œë˜ê·¸ê°€ ìˆìŠµë‹ˆë‹¤ :
-C, --channelID <string> ì²´ì¸ ì½”ë“œë¥¼ ì—…ê·¸ë ˆì´ë“œí•´ì•¼í•˜ëŠ” ì±„ë„ì˜ ì´ë¦„ì…ë‹ˆë‹¤.
-c, --ctor <string> JSON í˜•ì‹ì˜ ì²´ì¸ ì½”ë“œ ìƒì„±ì ë©”ì‹œì§€ (ê¸°ë³¸ê°’ "{}")
-E, --escc <string> ì´ ì²´ì¸ ì½”ë“œì— ì‚¬ìš©í•  ë³´ì¦ ì‹œìŠ¤í…œ ì²´ì¸ ì½”ë“œì˜ ì´ë¦„ (ê¸°ë³¸ê°’ "escc")
-n, --name <string> ì—…ê·¸ë ˆì´ë“œë˜ëŠ” ì²´ì¸ ì½”ë“œì˜ ì´ë¦„
-P, --policy <string> ì´ ì²´ì¸ ì½”ë“œì™€ ê´€ë ¨ëœ ë³´ì¦ ì •ì±…. ê¸°ë³¸ì ìœ¼ë¡œ íŒ¨ë¸Œë¦­ì€ "í˜„ì¬ ì±„ë„ì— ìˆëŠ” ì¡°ì§ì˜ ëª¨ë“  êµ¬ì„±ì›"ê³¼ ë™ì¼í•œ ë³´ì¦ ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤.
-v, --version <string> ì—…ê·¸ë ˆì´ë“œ ëœ ì²´ì¸ ì½”ë“œì˜ ë²„ì „
-V, --vscc <string> ì´ ì²´ì¸ ì½”ë“œì— ì‚¬ìš©í•  í™•ì¸ ì‹œìŠ¤í…œ ì²´ì¸ ì½”ë“œ ì´ë¦„ (ê¸°ë³¸ê°’ : "vscc")
https://hyperledger-fabric.readthedocs.io/en/release-1.4/command_ref.html

```



*****



###### ëª…ë ¹ì„ ë‚ ë ¤ë´…ì‹œë‹¤



1. `peer chaincode query -n jes -c '{"Args":["get","a"]}' -C mychannel`

   -> 10ì´ë¼ëŠ” ê°’ì„ ì¤Œ

   ![15](https://user-images.githubusercontent.com/20276476/79826075-bc617e00-83d5-11ea-96ba-f845285bc38a.png)

   ë¸”ëŸ­ì˜ í¬ê¸°ëŠ” ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤



2. peer chaincode invoke -n jes -c '{"Args":["set","a","20"]}' -C mychannel

   -> aì˜ ê°’ì„ 20ìœ¼ë¡œ ë³€ê²½

   ![16](https://user-images.githubusercontent.com/20276476/79826179-fc286580-83d5-11ea-9c61-8e66de1665ca.png)



genesisë¸”ëŸ­ì€ ì±„ë„ì´ êµ¬ì„±ë˜ì—ˆì„ ë•Œ ordererê°€ ì œë„¤ì‹œìŠ¤ ë¸”ë¡ì„ ë§Œë“¤ì–´ì„œ peerí•œí…Œ ì¤Œ



peerëŠ” ëª…ë ¹ì„ ë‚´ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì›ì¥ì„ ê°€ì§€ëŠ” ê²ƒì´ ëª©í‘œ

ì»¨ì†Œì‹œì—„ì´ êµ¬ì„±ë˜ë©´ ëˆ„êµ°ê°€ê°€ íŠ¸ëœì ì…˜ì„ ì¼ìœ¼í‚¤ëŠ” ê²ƒì„ ê¸°ë‹¤ë¦°ë‹¤



ì—”ëŒì„œê°€ ëª…ë ¹ì´ ì˜¤ëŠ” ê²ƒì„ ë°›ì•„ì„œ ìˆ˜í–‰í•œë‹¤

queryë¡œ ì˜¤ë©´ ì„œëª…, readset, writesetë“±ì„ ìˆ˜í–‰í•˜ì§€ ì•ŠìŒ(ì“¸ë°ì—†ëŠ” ì‘ì—… ì•ˆí•¨)

-> ìµœì‹ ì˜ ê°’ë§Œ ë¶ˆëŸ¬ì˜´ -> worldstateì—ì„œ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤

invorkëŠ” ì„œëª…ê³¼ readset, writesetì‘ì—…ì„ í•¨

ordererëŠ” writesetì˜ ë‚´ìš©ì„ ê·¸ëƒ¥ ì“´ë‹¤(ê²€ì‚¬ x) -> ì´ ë‚´ìš©ì„ commiterì—ê²Œ ë‹¤ ì „ë‹¬(peer)

-> ì´ë•Œ readset, writesetë„ ì „ë‹¬ë˜ì–´ ì˜¨ë‹¤(ë³´ì¦) or ë¸”ëŸ­ì´ ì˜¤ë©´ readset, writesetì„ ë‹¤ì‹œ ë§Œë“¤ì–´ë³¸ í›„ ê°™ì€ ê°’ì´ë©´ ë¶™ì„(ê²€ì¦)



*****



###### ë¶€ë¡ - IBM Cloud

https://cloud.ibm.com

catalog -> virtual server

í¼ë¸”ë¦­

ë¶ë¯¸ë‚¨ë¶€ - ëŒˆëŸ¬ìŠ¤

ë©”ëª¨ë¦¬ 4vCPUS, 32 GB RAM

Ubuntu 18.04

ìŠ¤í† ë¦¬ì§€ 100GB

ì—…ë§í¬ í¬íŠ¸ ì†ë„ 1Gbps ë“±ê¸‰ ì œí•œ ì—†ëŠ” ê³µìš© ë° ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ ì—…ë§í¬

ê°œì¸ìš© ë³´ì•ˆê·¸ë£¹, ê³µìš© ë³´ì•ˆê·¸ë£¹ ëª¨ë‘ ì„ íƒ





